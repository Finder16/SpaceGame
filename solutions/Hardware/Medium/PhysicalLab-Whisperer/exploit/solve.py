from pwn import *

def connectPin(num, pin1, pin2):
    r.sendlineafter(b"choice: ", b"2")
    r.sendlineafter(b"num: ", str(num))
    r.sendlineafter(b"connect: ", pin1)
    r.sendlineafter(b"connect: ", pin2)

r = remote('localhost', 55666)

r.sendlineafter(": ", b"STM32F205")

connectPin(1, b"Crowbar", b"Vcap")
connectPin(1, b"NRST", b"NRST")
connectPin(2, b"SWIO", b"PA13")
connectPin(2, b"CLK", b"PA14")
connectPin(2, b"SWO", b"PB3")
connectPin(2, b"Vref", b"VDD")

r.sendlineafter(b"choice: ", b"3")
r.sendlineafter(b"= ", b"rising_edge")
r.sendlineafter(b"= ", b"system")
r.sendlineafter(b"= ", b"True")
r.sendlineafter(b"= ", b"pll")
r.sendlineafter(b"= ", b"ext_single")
r.sendlineafter(b"= ", b"enable_only")
r.sendlineafter(b"= ", b"nrst")
r.sendlineafter(b"= ", b"high_z")
r.sendlineafter(b"= ", b"True")
r.sendlineafter(b"= ", b"False")

r.sendlineafter(b"choice: ", b"4")
r.recvuntil(b'hspace')
flag = r.recvline()
print(flag)

r.interactive()