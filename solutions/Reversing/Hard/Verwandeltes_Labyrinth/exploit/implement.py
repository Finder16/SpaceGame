import copy

switch_table = [19, 15, 16, 12, 24, 56, 23, 11, 6, 5, 20, 12, 16, 9, 3, 6, 1, 52, 58, 44, 22, 4, 6, 36, 54, 46, 55, 7, 18, 32, 7, 37, 47, 24, 49, 8, 16, 8, 19, 22, 14, 39, 34, 30, 48, 37, 36, 50, 26, 30, 30, 48, 34, 36, 20, 24, 18, 12, 31, 36, 44, 39, 10, 28]
xor_table = [127, 59, 100, 15, 68, 55, 101, 82, 94, 71, 112, 78, 45, 20, 64, 7, 114, 94, 55, 21, 66, 76, 109, 84, 88, 77, 57, 4, 52, 3, 96, 51, 62, 68, 66, 2, 123, 39, 84, 89, 110, 68, 40, 27, 88, 104, 34, 75, 71, 90, 96, 9, 38, 77, 94, 126, 26, 23, 2, 78, 26, 99, 1, 88]
add_table = [4, 88, 113, 83, 25, 40, 23, 127, 83, 39, 114, 21, 78, 57, 72, 109, 94, 18, 81, 62, 113, 21, 112, 103, 6, 15, 88, 39, 115, 107, 59, 119, 67, 45, 75, 93, 85, 98, 92, 40, 9, 79, 61, 87, 8, 5, 69, 102, 23, 22, 36, 8, 43, 21, 111, 50, 36, 72, 89, 24, 51, 21, 15, 119]
ROL_table = [39, 67, 91, 35, 106, 47, 124, 89, 116, 36, 116, 76, 13, 23, 23, 84, 113, 119, 93, 23, 69, 59, 21, 95, 82, 23, 46, 108, 122, 47, 69, 34, 115, 32, 69, 93, 79, 65, 54, 67, 102, 43, 16, 115, 66, 39, 71, 51, 31, 36, 74, 100, 96, 95, 67, 50, 118, 113, 31, 113, 33, 100, 19, 20]


inp = "F3238BA37FF304210D252BF23071006221E03CE8CAB4A345FDB66C185E2C964C"

buf = []
for i in inp:
    buf.append(ord(i))
assert len(buf) == 64

random_func = [1, 4, 4, 4, 1, 1, 2, 2, 2, 2, 2, 3, 2, 2, 1, 1, 1, 4, 4, 1, 4, 4, 3, 4, 4, 1, 1, 1, 2, 2, 1, 1]

global cnt
cnt = 0
def get_rand():
    global cnt
    res = random_func[cnt] % 4
    cnt += 1
    cnt %= len(random_func)
    return res

def rol_func(val, operand):
    if operand == 0:
        return val
    tmp = val & 0x0f
    for i in range(operand):
        tmp = (tmp << 1) | (tmp >> 3)
        tmp &= 0x0f
    res = tmp + (val & 0xf0)
    return res

for i in range(500):
    dst_ = get_rand()
    if dst_ == 0:
        dst = copy.deepcopy(add_table)
    elif dst_ == 1:
        dst = copy.deepcopy(buf)
    elif dst_ == 2:
        dst = copy.deepcopy(xor_table)
    elif dst_ == 3:
        dst = copy.deepcopy(ROL_table)
    func_num = get_rand()
    if (dst_ != 1):
        while (func_num == dst_):
            func_num = get_rand()
    #print(dst_, func_num)
    if func_num == 0:
        for j in range(64):
            dst[j] += add_table[j]
            dst[j] %= 128
    elif func_num == 1:
        for j in range(64):
            tmp = dst[switch_table[j]]
            dst[switch_table[j]] = dst[0]
            dst[0] = tmp
    elif func_num == 2:
        for j in range(64):
            dst[j] ^= xor_table[j]
    elif func_num == 3:
        for j in range(64):
            dst[j] = rol_func(dst[j], ROL_table[j])
    if dst_ == 0:
        add_table = copy.deepcopy(dst)
    elif dst_ == 1:
        buf = copy.deepcopy(dst)
    elif dst_ == 2:
        xor_table = copy.deepcopy(dst)
    elif dst_ == 3:
        ROL_table = copy.deepcopy(dst)

print(buf)
