# 문제이름 : 아크 
# 출제자명 : 이성민(8l4nk)
# 컨셉: AARCH64 어셈블리 해석 
# 최종본 한번 더 낼게요...



요약 : 
1. 어셈블리 깡 코딩을 해서 IDA나 Ghidra로 열어보면 함수가 괴상하게 적혀있습니다.
2. 함수 호출하는 코드도 존재하는데, 인자가 명시되어 있지 않습니다. (레지스터를 제 맘대로 써서 제대로 해석이 불가합니다.)
3. 인자로 뭐가 넘어가는지는 어셈블리를 확인해야하며, 크게 어렵지 않습니다.
4. FUN_0040011c 함수에 넘어가는 인자는 x21이며, LAB_004000C8 기준 입력한 문자열의 길이입니다.
5. FUN_0040011c 로 넘어가서 x23 레지스터가 index로 하여금 길이 만큼 for문을 돕니다.
6. 총 3개의 함수를 도는데 들어가면 의사코드로는 보이지 않습니다.
	w14 기준으로 indexing 하며
	- FUN_0040015c : 굉장히 많은 레이블이 들어갔지만 사실 크게 어렵지 않습니다. 결론만 말하자면 3bit ror하는 코드입니다.
	w17 레지스터에 w14 값을 옮깁니다. 
	- FUN_0040015c : 그저 ((w17+len) + len) & 0xff 코드입니다.
	w14 레지스터에 w17 값을 옮깁니다.
	- FUN_004001d8 : x23, for문의 index 기준으로 DAT_004102b0 기준으로 비교를 하는 코드입니다.
				Left shift 3 연산을 계속해서 table 접근을 하기때문에, DAT_00410220 부터 쭉 값 비교를 하며 앞에 계산과 table이 일치한지 비교합니다.

7. 이 모든 연산이 끝나고 w22 레지스터에 값이 0이면 correct로 판정하고 프로그램을 종료합니다.


flag : hspace{1_4dm1t_4a4a4arch64_4ss3mbly_1s_v3ry_e4sy_4ft3r_4ll_0f_guys_hehe}
