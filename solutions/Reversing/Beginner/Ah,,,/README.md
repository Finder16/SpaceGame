# Ah...?

# Usage


# Concept
- esolang

# Writeup

#### ah.c
```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char flag[9][115] = {
    {0xeb, 0xb0, 0x9e, 0xeb, 0xb9, 0xa0, 0xeb, 0x95, 0x85, 0xeb, 0xb0, 0x9d, 0xeb, 0xb0, 0x95, 0xeb, 0x94, 0xb0, 0xeb, 0x8b, 0xb9, 0xeb, 0xb0, 0x9f, 0xeb, 0x8b, 0xa4, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0xa3, 0xeb, 0xb0, 0xa1, 0xeb, 0x95, 0x85, 0xeb, 0xb0, 0x95, 0xeb, 0xb0, 0x9b, 0xeb, 0x94, 0xb0, 0xeb, 0xb0, 0xa0, 0xeb, 0x94, 0xb0, 0xeb, 0xb0, 0x98, 0xeb, 0xb0, 0x98, 0xeb, 0x82, 0x9c, 0xeb, 0x8b, 0xa8, 0xeb, 0x8b, 0xa8, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0xa4, 0xeb, 0xb0, 0x9c, 0xeb, 0xb0, 0x99, 0xeb, 0x94, 0xb0, 0xeb, 0x94, 0xb0, 0xeb, 0xb0, 0x9c, 0xed, 0x83, 0x95, 0xeb, 0xb0, 0x9b, 0xeb, 0xb0, 0x9c, 0xeb, 0x94, 0xb4, 0xeb, 0x8b, 0xa8, 0xeb, 0xb0, 0x98, 0xeb, 0x8b, 0xa4, 0xeb, 0xad, 0x8f, 0x0},
    {0xeb, 0xb6, 0x86, 0xeb, 0xb2, 0x8c, 0xeb, 0xa9, 0x93, 0xeb, 0x8d, 0x98, 0xeb, 0x8d, 0x98, 0xeb, 0xbb, 0x94, 0xeb, 0x96, 0xa8, 0xeb, 0xb2, 0x8c, 0xeb, 0xb2, 0x88, 0xeb, 0x96, 0xa4, 0xeb, 0xbb, 0xa3, 0xeb, 0xb2, 0x8e, 0xeb, 0xa9, 0x93, 0xeb, 0x8d, 0x9c, 0xeb, 0x8d, 0x98, 0xeb, 0xb2, 0x93, 0xeb, 0xb2, 0x97, 0xeb, 0x8d, 0x98, 0xeb, 0xb2, 0x93, 0xeb, 0x96, 0xb3, 0xeb, 0xbb, 0x94, 0xeb, 0x96, 0xb5, 0xeb, 0xbb, 0x90, 0xeb, 0xb2, 0x8b, 0xeb, 0xa9, 0x93, 0xeb, 0x8d, 0xa4, 0xeb, 0x8d, 0xaa, 0xeb, 0xb2, 0x85, 0xeb, 0x96, 0xa8, 0xeb, 0xb2, 0x8b, 0xeb, 0x8d, 0x9c, 0xeb, 0xb2, 0x8b, 0xeb, 0xb2, 0x88, 0xeb, 0x96, 0xa1, 0xeb, 0xb2, 0x8c, 0xeb, 0x96, 0xa0, 0xeb, 0xb2, 0x86, 0xeb, 0xb2, 0x86, 0x0},
    {0xeb, 0xb0, 0x99, 0xeb, 0x94, 0xb0, 0xeb, 0x95, 0x85, 0xeb, 0xb0, 0xa7, 0xed, 0x83, 0x84, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0x9f, 0xeb, 0xb0, 0xa3, 0xeb, 0x94, 0xb0, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0xa6, 0xeb, 0xb0, 0x9b, 0xeb, 0xb0, 0x9b, 0xeb, 0x94, 0xb0, 0xeb, 0x94, 0xb0, 0xeb, 0xb0, 0xaa, 0xed, 0x83, 0x95, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0x98, 0xeb, 0xb0, 0x95, 0xeb, 0x8b, 0xa8, 0xeb, 0xb0, 0x9c, 0xeb, 0x8b, 0xac, 0xeb, 0xb0, 0x9e, 0xeb, 0x95, 0x89, 0xeb, 0xb0, 0x9b, 0xeb, 0xb0, 0x99, 0xeb, 0x95, 0x81, 0xeb, 0xb0, 0x98, 0xeb, 0x8b, 0xb4, 0xeb, 0x8b, 0xb9, 0xeb, 0xb0, 0x9c, 0xeb, 0xb0, 0x95, 0xeb, 0x94, 0xb4, 0xeb, 0x8b, 0xb9, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0xa1, 0xeb, 0xb6, 0x8a, 0x0},
    {0xeb, 0xb6, 0x81, 0xeb, 0xb2, 0x97, 0xeb, 0xa9, 0x93, 0xed, 0x84, 0xb4, 0xeb, 0x8d, 0x9c, 0xeb, 0xb2, 0x9c, 0xeb, 0xb2, 0x97, 0xeb, 0x8d, 0x9b, 0xeb, 0x96, 0xa7, 0xeb, 0xb2, 0x8c, 0xeb, 0xb2, 0x95, 0xeb, 0x96, 0xb9, 0xeb, 0x96, 0xb9, 0xeb, 0xb2, 0x8a, 0xeb, 0xb2, 0x94, 0xeb, 0xb2, 0x95, 0xeb, 0xa9, 0x93, 0xed, 0x85, 0x85, 0xeb, 0x8d, 0xaa, 0xeb, 0x8d, 0xad, 0xeb, 0xb2, 0x88, 0xeb, 0xb2, 0x8c, 0xeb, 0xb2, 0x8b, 0xeb, 0x96, 0xa4, 0xeb, 0xbb, 0xa5, 0xeb, 0x8d, 0xa7, 0xeb, 0xb2, 0x85, 0xeb, 0x96, 0xb3, 0xeb, 0xb2, 0x8b, 0xeb, 0xb2, 0x9a, 0xeb, 0xa9, 0x93, 0xeb, 0x8d, 0x98, 0xeb, 0x8d, 0xa9, 0xeb, 0x8d, 0xa4, 0xeb, 0x96, 0xa4, 0xeb, 0xb2, 0x8e, 0xeb, 0xb2, 0x8f, 0xeb, 0xb2, 0x92, 0x0},
    {0xeb, 0xb0, 0xaa, 0xeb, 0xb0, 0xac, 0xeb, 0x94, 0xb0, 0xeb, 0x95, 0x85, 0xeb, 0x95, 0x81, 0xeb, 0xb9, 0xb5, 0xeb, 0x8b, 0xb5, 0xeb, 0xb0, 0x98, 0xeb, 0xb0, 0xac, 0xeb, 0x8b, 0xb9, 0xeb, 0xb0, 0x9b, 0xeb, 0x95, 0x85, 0xeb, 0x8b, 0xa4, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0x98, 0xeb, 0xb0, 0x95, 0xeb, 0x94, 0xb7, 0xeb, 0xb0, 0x9b, 0xeb, 0x8b, 0xa4, 0xeb, 0xb0, 0xa4, 0xec, 0x96, 0x91, 0xea, 0xb0, 0xb1, 0xeb, 0x95, 0x89, 0xeb, 0xb9, 0xb5, 0xeb, 0xb9, 0xb5, 0xeb, 0xb9, 0xb5, 0xeb, 0x8b, 0xb5, 0xeb, 0x8b, 0xb5, 0xeb, 0x8b, 0xa8, 0xeb, 0xb0, 0x98, 0xeb, 0xb0, 0xa7, 0xeb, 0x82, 0x98, 0xed, 0x83, 0x95, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0x9b, 0xeb, 0xb0, 0xac, 0xeb, 0xb9, 0xa0, 0xeb, 0x9a, 0x9c, 0x0},
    {0xeb, 0x91, 0xa1, 0xeb, 0xb2, 0x95, 0xeb, 0xb2, 0x95, 0xeb, 0xb2, 0x95, 0xeb, 0xa9, 0x93, 0xed, 0x85, 0x83, 0xeb, 0xb2, 0x8c, 0xeb, 0x96, 0xb7, 0xeb, 0x96, 0xb7, 0xeb, 0x96, 0xb9, 0xeb, 0xbb, 0x97, 0xeb, 0xb2, 0x89, 0xeb, 0xbb, 0x94, 0xeb, 0xb2, 0x88, 0xeb, 0xa9, 0x93, 0xeb, 0x96, 0xb7, 0xeb, 0x96, 0xb7, 0xeb, 0x96, 0xb9, 0xeb, 0xbb, 0x97, 0xeb, 0xb2, 0x89, 0xeb, 0xbb, 0x94, 0xeb, 0xb2, 0x88, 0xeb, 0xa9, 0x93, 0xeb, 0x96, 0xb7, 0xeb, 0x96, 0xa4, 0xeb, 0xb2, 0x8b, 0xeb, 0xb2, 0x91, 0xeb, 0xb2, 0x86, 0xeb, 0xa9, 0x93, 0xeb, 0x8d, 0xa4, 0xeb, 0xbb, 0xa5, 0xeb, 0x8d, 0xa7, 0xeb, 0x96, 0xa0, 0xeb, 0x96, 0xa8, 0xeb, 0xb2, 0x8c, 0xeb, 0xb2, 0x88, 0xeb, 0xb2, 0x8b, 0xeb, 0x96, 0xa0, 0x0},
    {0xeb, 0x95, 0x89, 0xeb, 0xb0, 0x9a, 0xeb, 0xb0, 0xa3, 0xeb, 0x94, 0xb4, 0xeb, 0x8b, 0xa4, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0xa0, 0xeb, 0xb0, 0xa4, 0xeb, 0x8b, 0xa4, 0xeb, 0xb9, 0xb5, 0xeb, 0x94, 0xb8, 0xeb, 0xb0, 0xad, 0xeb, 0xb0, 0x9c, 0xeb, 0x94, 0xb0, 0xed, 0x83, 0x88, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0x9b, 0xeb, 0xb0, 0x9b, 0xeb, 0xb0, 0xa4, 0xeb, 0xb0, 0xaa, 0xeb, 0x94, 0xb0, 0xeb, 0x94, 0xb0, 0xeb, 0x94, 0xb4, 0xeb, 0xb9, 0xb5, 0xeb, 0xa7, 0xa3, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0x99, 0xeb, 0xb0, 0x9a, 0xeb, 0x8b, 0xa8, 0xeb, 0xb0, 0x96, 0xeb, 0x95, 0x88, 0xeb, 0xb0, 0xa3, 0xeb, 0x8b, 0xb7, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0x95, 0xeb, 0xb0, 0x99, 0xeb, 0x95, 0x81, 0xeb, 0xbf, 0xa1, 0x0},
    {0xeb, 0xb6, 0x8b, 0xeb, 0xb2, 0x95, 0xeb, 0xa9, 0x93, 0xeb, 0x8d, 0xaf, 0xeb, 0xb2, 0x9a, 0xeb, 0x8d, 0x94, 0xeb, 0xbb, 0xa5, 0xeb, 0x96, 0xa7, 0xeb, 0xbb, 0x94, 0xeb, 0xb2, 0x8d, 0xeb, 0xa9, 0x93, 0xeb, 0x8d, 0x94, 0xeb, 0x8d, 0xad, 0xeb, 0x96, 0xa8, 0xeb, 0xb2, 0x89, 0xeb, 0xb2, 0x95, 0xeb, 0x8d, 0xa4, 0xeb, 0x8d, 0xa4, 0xeb, 0xbb, 0x90, 0xeb, 0xbb, 0xa5, 0xeb, 0x96, 0xb9, 0xeb, 0x96, 0xb6, 0xeb, 0xbb, 0x90, 0xeb, 0xb2, 0x9a, 0xeb, 0xb2, 0x9c, 0xeb, 0xb2, 0x8b, 0xeb, 0xa9, 0x93, 0xeb, 0x96, 0xa4, 0xeb, 0xb2, 0x8c, 0xeb, 0x8d, 0x98, 0xeb, 0x96, 0xb9, 0xeb, 0xb2, 0x9c, 0xeb, 0xb2, 0x9a, 0xeb, 0xb2, 0x9b, 0xeb, 0xa9, 0x93, 0xed, 0x84, 0xb7, 0xeb, 0xb2, 0x8c, 0xeb, 0x96, 0xa1, 0x0},
    {0xeb, 0x94, 0xb4, 0xeb, 0xb0, 0x9b, 0xeb, 0x95, 0x89, 0xeb, 0xb0, 0x9e, 0xeb, 0x8b, 0xa4, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0x9d, 0xeb, 0xb0, 0x9a, 0xeb, 0x95, 0x89, 0xeb, 0xb0, 0xac, 0xeb, 0x95, 0x89, 0xeb, 0xa7, 0xa3, 0xeb, 0xb0, 0x9c, 0xeb, 0xb0, 0x99, 0xeb, 0xb0, 0x9a, 0xeb, 0x95, 0x8b, 0xeb, 0x95, 0x85, 0xeb, 0xa7, 0xa3, 0xec, 0x95, 0xa0, 0xec, 0x95, 0x84, 0xec, 0x95, 0x84, 0xec, 0x99, 0x80, 0xec, 0x95, 0xa0, 0xec, 0x95, 0x84, 0xec, 0x99, 0xb8, 0xec, 0x9b, 0x8c, 0xec, 0x9b, 0xa8, 0xec, 0x9c, 0x84, 0xec, 0x95, 0xa0, 0xec, 0x95, 0x84, 0xec, 0x95, 0x84, 0xec, 0x95, 0x84, 0xec, 0x97, 0x90, 0xec, 0x98, 0x88, 0xec, 0x96, 0x98, 0xec, 0x9b, 0x8c, 0xec, 0x9b, 0xa8, 0xed, 0x9d, 0xac, 0x0}
};

unsigned char key[5] = "aheui";
unsigned char check[] = {0x80, 0x81, 0x1, 0x1, 0x80, 0x6, 0x1, 0x82, 0x4, 0x0, 0x86, 0x0, 0x83, 0x2, 0x0, 0x7, 0x0, 0x0, 0x82, 0x2, 0x6, 0x0, 0x80, 0x4, 0x3, 0x4, 0x0, 0x0, 0x0, 0x0, 0x87, 0x86};

unsigned char fake_flag[31] = {0x9, 0x1b, 0x15, 0x14, 0xa, 0x65, 0x13, 0x11, 0x1d, 0x58, 0x73, 0x37, 0xc, 0x6, 0x7, 0x27, 0x1c, 0x3a, 0xc, 0x59, 0x75, 0x37, 0x12, 0x41, 0x7, 0x74, 0x37, 0x3, 0x45, 0x1b, 0x7d};

void print_flag_1()
{
    FILE * f_1;
    f_1 = fopen("flag_out", "a");

    for(int i = 0; i<9; i++)fputs(flag[i], f_1);

    fclose(f_1);
}


void aheui()
{
    unsigned int i, j = 0;
    unsigned char xor[31];

    FILE * ahi;
    ahi = fopen("You_want_this", "w");

    for(i = 0; i < 31; i++){
        xor[i] = fake_flag[i] ^ key[j];
        if(j == 5) j = 0;
        j++;
    }

    fputs(xor, ahi);

    fclose(ahi);

    printf("Check the flag!\n");
}

//set no option
int main()
{
    unsigned char input[5], flag[31];
    unsigned int i, j = 0, cmp_val, check_flag;

    printf("Do you want flag? (YES/NO): ");
    scanf("%s", input);

    cmp_val = strncmp("aheui", input, 5);

    if(cmp_val == 0){
        print_flag_1();
        printf("Now, check the flag\n");
        exit(0);
    }

    if(strncmp("y", input, 1) == 0 || strncmp("Y", input, 1) == 0 || strncmp("yes", input, 3) == 0 || strncmp("YES", input, 3) == 0){
        printf("Here you go.\n");
        aheui();
        exit(0);
    }

    else if(strncmp("n", input, 1) == 0 || strncmp("N", input, 1) == 0 || strncmp("NO", input, 2) == 0 || strncmp("No", input, 2) == 0) printf("Then do you know the flag?\n");

    printf("Flag: ");
    scanf("%s", flag);

    for(i = 0; i < 31; i++){
        flag[i] ^= key[j];
        flag[i] = (flag[i] >> 3) % 0xff;
        flag[i] = (flag[i] << 7) % 0xff;
        if(j == 5) j = 0;
        j++;
    }

    check_flag = strncmp(check, flag, 31);

    if(check_flag == 0){
        printf("Great Job!! You did it!!\n");
    }
    else if(check_flag != 0) printf("Try again.\n");

    return 0;
}
```

우선 프로그램을 실행 시켜보면 `Do you want flag? (YES/NO):`라는 입력을 받는 부분이 나오게 됩니다. 각각 `yes`와 `no`를 입력해보면 `yes`를 입력했을 때 `You_want_this`라는 파일을 만들고 끝나는 모습을 확인 할 수 있습니다. 그리고 만들어진 파일을 확인하면 `hspace{th1s_isn't_y0u_w4nt_f0r}`라는 내용을 확인할 수 있습니다. 다음으로 `no`를 입력해보면 `Then do you know the flag?`문장과 함께 플래그를 입력하는 부분이 나오게 됩니다. 앞서 얻은 플래그를 입력해보면 `Try again.`이라는 문자열이 출력됩니다. 

이제 파일을 디컴파일 해서 확인해보면 첫 번쨰 입력은 `YES(yes, Y, y)`, `NO(no, N, n)`, 그리고 `aheui`의 입력으로 세가지의 분기로 나뉘는 것을 알 수 있습니다. 앞서 프로그램을 실행시켜 보는 것으로 앞의 두가지 경우는 확인 했으니 마지막 `aheui`의 내용을 살펴보도록 하겠습니다. 기드라 기준으로 `FUN_00101249`함수를 확인해 보면 `flag_ou`이라는 파일로 어떠한 데이터를 출력하는 것을 확인 할 수 있습니다. 이떄 사용되는 데이터는 `DAT_00104020`인데 다른 데이터 형식으로 변형하여도 특별한 문자열이 나오지 않습니다. 그럼 일단 다시 프로그램을 실행시켜서 출력되는 파일을 확인해보도록 하겠습니다. 프로그램을 실행시키고 `aheui`를 입력하니 `Now, check the flag`라는 문자열이 나왔습니다. 그리고 `flag_out`라는 파일이 생성되었습니다. 이를 확인해보면 아래와 같은 내용을 확인 할 수 있습니다.
```
밞빠땅밝박따당밟다맣밣밡땅박받따밠따반반난단단맣밤발밙따따발탕받발딴단반다뭏붆벌멓던던뻔떨벌번떤뻣벎멓덜던벓벗던벓떳뻔떵뻐벋멓덤덪벅떨벋덜벋번떡벌떠벆벆밙따땅밧탄맣밟밣따맣밦받받따따밪탕맣반박단발달밞땉받밙땁반담당발박딴당맣밡붊북벗멓턴덜벜벗덛떧벌법떹떹벊범법멓텅덪덭번벌벋떤뻥덧벅떳벋벚멓던덩덤떤벎벏벒밪밬따땅땁빵답반밬당받땅다맣반박딷받다밤양갱땉빵빵빵답답단반밧나탕맣받밬빠뚜둡법법법멓텃벌떷떷떹뻗벉뻔번멓떷떷떹뻗벉뻔번멓떷떤벋벑벆멓덤뻥덧떠떨벌번벋떠땉밚밣딴다맣밠밤다빵딸밭발따탈맣받받밤밪따따딴빵맣맣밙밚단밖땈밣닷맣박밙땁뿡붋법멓덯벚더뻥떧뻔벍멓더덭떨벉법덤덤뻐뻥떹떶뻐벚벜벋멓떤벌던떹벜벚벛멓턷벌떡딴받땉밞다맣밝밚땉밬땉맣발밙밚땋땅맣애아아와애아외워웨위애아아아에예얘워웨희
```
위 내용과 디컴파일 도중 틈틈히 확인 할 수 있었던 `aheui`를 통해서 위 내용은 아희라는 언어를 이용한 내용임을 알 수 있습니다. 그러나 아희 인터프리터를 이용하면 hsp라는 내용만 나오는 것을 알 수 있는데, 위 코드가 문법에 맞게 이루어지지 않았기 때문입니다. 아희의 커서의 이동이 매끄럽게 이루어지게 코드를 수정해 주면 아래와 같습니다.
```
밞빠땅밝박따당밟다맣밣밡땅박받따밠따반반난단단맣밤발밙따따발탕받발딴단반다뭏
붆벌멓던던뻔떨벌번떤뻣벎멓덜던벓벗던벓떳뻔떵뻐벋멓덤덪벅떨벋덜벋번떡벌떠벆벆
밙따땅밧탄맣밟밣따맣밦받받따따밪탕맣반박단발달밞땉받밙땁반담당발박딴당맣밡붊
북벗멓턴덜벜벗덛떧벌법떹떹벊범법멓텅덪덭번벌벋떤뻥덧벅떳벋벚멓던덩덤떤벎벏벒
밪밬따땅땁빵답반밬당받땅다맣반박딷받다밤양갱땉빵빵빵답답단반밧나탕맣받밬빠뚜
둡법법법멓텃벌떷떷떹뻗벉뻔번멓떷떷떹뻗벉뻔번멓떷떤벋벑벆멓덤뻥덧떠떨벌번벋떠
땉밚밣딴다맣밠밤다빵딸밭발따탈맣받받밤밪따따딴빵맣맣밙밚단밖땈밣닷맣박밙땁뿡
붋법멓덯벚더뻥떧뻔벍멓더덭떨벉법덤덤뻐뻥떹떶뻐벚벜벋멓떤벌던떹벜벚벛멓턷벌떡
딴받땉밞다맣밝밚땉밬땉맣발밙밚땋땅맣애아아와애아외워웨위애아아아에예얘워웨희
```
그리고 아희 인터프리터를 이용해서 실행을 시켜주면 다음과 같은 플래그를 얻을 수 있습니다. 
`hspace{H3llo_World_Hell0_Aheui}`

#### ex
```
1. ./prog -> 프로그램 실행
2. aheui -> 플래그 출력
3. 아희 문법에 맞게 코드 수정 및 인터프리터에 넣어서 플래그 구하기
4. ./prog -> 프로그램 재실행
5. no -> 플래그 입력으로 진입
6. hspace{H3llo_World_Hell0_Aheui} -> 플래그 입력
```